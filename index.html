<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Load external CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jfishsheff/roocrawl23@main/styles.css">

  <!-- Google OAuth client -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <!-- External JS -->
  <script src="https://cdn.jsdelivr.net/gh/jfishsheff/roocrawl23@main/script.js" defer></script>

  <title>Organic Growth Reports</title>
</head>
<body>

<div class="container">

  <!-- Steps card -->
  <div class="card steps-card">

    <div class="step">
      <div class="step-number">1</div>
      <div class="step-content">
        <strong>Log into your Google account</strong>
        <div>If you have issues, email <a href="mailto:joemfisher1@gmail.com">joemfisher1@gmail.com</a></div>
      </div>
    </div>

    <div class="step">
      <div class="step-number">1.5</div>
      <div class="step-content">
        <strong>Select your GSC property</strong>
        <div>Required for search query growth reports.</div>
      </div>
    </div>

    <div class="step">
      <div class="step-number">2</div>
      <div class="step-content">
        <strong>Select your GA4 account and property</strong>
        <span class="help-trigger" id="ga4-help-trigger">Help</span>
        <div class="help-box" id="ga4-help-box">
          <strong>How this works:</strong><br><br>
          1. Click Sign in with Google<br>
          2. Choose the Google account that has access<br>
          3. Select the account<br>
          4. Select the property<br>
          5. Click Load Data
        </div>
      </div>
    </div>

    <div class="step">
      <div class="step-number">3</div>
      <div class="step-content">
        <strong>Review reports</strong>
      </div>
    </div>

  </div>

  <!-- Main card -->
  <div class="card">

    <h1>Organic Growth Reports</h1>
    <p class="subtitle">Shows organic session growth, engagement growth and Search Console query growth.</p>

    <!-- Auth section -->
    <div class="auth-section">
      <button id="ga-signin" class="btn btn-primary">Sign in with Google (GA4)</button>
      <button id="ga-signout" class="btn btn-secondary" style="display:none;">Sign out GA4</button>
      <span id="ga-status" class="status" style="display:none;"></span>

      <button id="gsc-signin" class="btn btn-primary">Sign in with Google (GSC)</button>
      <button id="gsc-signout" class="btn btn-secondary" style="display:none;">Sign out GSC</button>
      <span id="gsc-status" class="status" style="display:none;"></span>
    </div>

    <!-- GA4 selection -->
    <div id="property-input-wrapper" class="input-section">
      <div class="input-group">
        <div>
          <label for="ga-account-select" class="input-label">Select GA4 account</label>
          <select id="ga-account-select" class="select">
            <option value="">Loading accounts...</option>
          </select>
        </div>

        <div>
          <label for="ga-property-select" class="input-label">Select GA4 property</label>
          <select id="ga-property-select" class="select" disabled>
            <option value="">Select an account first</option>
          </select>
        </div>

        <button id="ga-load" class="btn btn-primary" disabled>Load GA4 data</button>
      </div>
    </div>

    <!-- GSC selection -->
    <div id="gsc-input-wrapper" class="input-section">
      <div class="input-group">
        <div>
          <label for="gsc-property-select" class="input-label">Select GSC property</label>
          <select id="gsc-property-select" class="select" disabled>
            <option value="">Sign in to GSC first</option>
          </select>
        </div>

        <button id="gsc-load" class="btn btn-primary" disabled>Load GSC data</button>
      </div>
    </div>

    <!-- Property info -->
    <div id="property-domain" class="property-info"></div>

    <!-- Results section -->
    <div id="ga-results" class="results-section">

      <!-- MoM -->
      <div class="results-subsection" id="mom-section">
        <div class="results-header">
          <h2 class="results-title">Month over month session growth</h2>
        </div>

        <div class="table-wrapper">
          <table id="ga-table-mom">
            <thead>
              <tr>
                <th>Landing page</th>
                <th>Last 28 days</th>
                <th>Previous 28 days</th>
                <th>MoM growth</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <!-- WoW -->
      <div class="results-subsection" id="wow-section">
        <div class="table-wrapper">
          <table id="ga-table-wow">
            <thead>
              <tr>
                <th>Landing page</th>
                <th>Last 7 days</th>
                <th>Previous 7 days</th>
                <th>WoW growth</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <!-- YoY -->
      <div class="results-subsection" id="yoy-section">
        <div class="table-wrapper">
          <table id="ga-table-yoy">
            <thead>
              <tr>
                <th>Landing page</th>
                <th>Last 365 days</th>
                <th>Previous 365 days</th>
                <th>YoY growth</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <!-- GSC -->
      <div class="results-subsection" id="gsc-query-section">

        <h2 class="results-title">Search Console query growth</h2>

        <div class="table-wrapper">
          <table id="gsc-wow-table">
            <thead>
              <tr>
                <th>Query</th>
                <th>Last 7 days</th>
                <th>Previous 7 days</th>
                <th>WoW</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="table-wrapper">
          <table id="gsc-mom-table">
            <thead>
              <tr>
                <th>Query</th>
                <th>Last 28 days</th>
                <th>Previous 28 days</th>
                <th>MoM</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="table-wrapper">
          <table id="gsc-yoy-table">
            <thead>
              <tr>
                <th>Query</th>
                <th>Last 365 days</th>
                <th>Previous 365 days</th>
                <th>YoY</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

      </div>

    </div>

  </div>

</div>

<script>
  window.onload = () => initOAuth();
</script>

</body>
</html>
